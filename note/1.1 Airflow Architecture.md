# Airflow Architecture

(이번 장은 Airflow 의 운영 관점에서 Airflow를 이해하는 것이 목표입니다)

<pre>
<b>환경 변수 설정 방법</b>

1. Environment variable (`AIRFLOW__[SECTION]__[KEY]`)
2. Command environment variable (`AIRFLOW__[SECTION]__[KEY]_CMD`)
3. In `airflow.cfg`
4. Command in `airflow.cfg`
5. Default value
</pre>

Airflow 는 세 개의 컴포넌트로 구성되어 있습니다.

- Webserver
- Scheduler
- Database

<br/><img src="./img/image1.png" width="60%" /><br/>

`Webserver` 와 `Scheduler` 모두 Airflow process 입니다.
데이터베이스는 분리된 서비스로, `Webserver` 와 `Scheduler에서` 메타데이터를 저장하기 위해 사용됩니다.
DAG들이 정의된 파일은 반드시 `Scheduler`가 접근할 수 있어야 합니다.


<br/>

#### Airflow 1

`Webserver` 와 `Scheduler`에서 반드시 DAG 파일들에 접근할 수 있게 해야 했습니다.
여러 머신 간에 파일들이 공유되어야 하거나 단순한 프로세스가 아니었기 때문에 이런 복잡한 배포가 필요했습니다.

<br/>

#### Airflow 2

DAG들은 데이터베이스 내 직렬화된(Serialized) 형태로 작성됩니다. `Webserver`는 이렇게 직렬화된 형식을 DB로 부터 읽었으며, 이런 이유로 DAG 에 접근할 필오가 없습니다.


 



